// Add this to your schema.prisma file

model MigrationHistory {
  id                String      @id @default(uuid())
  shopDomain        String
  status            String      // 'PENDING', 'PROCESSING', 'COMPLETED', 'FAILED'
  totalRecords      Int         @default(0)
  processedRecords  Int         @default(0)
  failedRecords     Int         @default(0)
  errors            Json?       // Array of error messages
  metadata          Json?       // Migration configuration
  startedAt         DateTime?
  completedAt       DateTime?
  createdAt         DateTime    @default(now())
  
  @@index([shopDomain])
  @@index([status])
  @@index([createdAt])
}

// SQL Migration
/*
CREATE TABLE "MigrationHistory" (
    "id" TEXT NOT NULL DEFAULT gen_random_uuid(),
    "shopDomain" TEXT NOT NULL,
    "status" TEXT NOT NULL,
    "totalRecords" INTEGER NOT NULL DEFAULT 0,
    "processedRecords" INTEGER NOT NULL DEFAULT 0,
    "failedRecords" INTEGER NOT NULL DEFAULT 0,
    "errors" JSONB,
    "metadata" JSONB,
    "startedAt" TIMESTAMP(3),
    "completedAt" TIMESTAMP(3),
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT "MigrationHistory_pkey" PRIMARY KEY ("id")
);

CREATE INDEX "MigrationHistory_shopDomain_idx" ON "MigrationHistory"("shopDomain");
CREATE INDEX "MigrationHistory_status_idx" ON "MigrationHistory"("status");
CREATE INDEX "MigrationHistory_createdAt_idx" ON "MigrationHistory"("createdAt");
*/